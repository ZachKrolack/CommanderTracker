<form [formGroup]="form">
    <p>
        Player {{ index + 1 }}
        <button
            mat-icon-button
            (click)="remove()"
            aria-label=""
        >
            <mat-icon color="warn">remove</mat-icon>
        </button>
    </p>
    <div>
        <!-- @if (decks$ | async; as decks) { -->
            <mat-form-field>
                <mat-label>Deck</mat-label>
                <mat-select formControlName="deckId">
                    @for (deck of decks; track deck.id) {
                        <mat-option [value]="deck.id">{{
                            deck.name
                        }}</mat-option>
                    }
                </mat-select>
                @if (
                    form.controls.deckId.errors?.[
                        "required"
                    ]
                ) {
                    <mat-error></mat-error>
                }
            </mat-form-field>
        <!-- } -->

        <!-- <button mat-icon-button aria-label="" (click)="openDeckFormDialog()">
            <mat-icon color="primary">add</mat-icon>
        </button> -->
    </div>

    <div>
        <!-- @if (pilots$ | async; as pilots) { -->
            <mat-form-field>
                <mat-label>Pilot</mat-label>
                <mat-select formControlName="pilotId">
                    @for (pilot of pilots; track pilot.id) {
                        <mat-option [value]="pilot.id">{{
                            pilot.name
                        }}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
        <!-- } -->

        <!-- <button mat-icon-button aria-label="" (click)="openPilotFormDialog()">
            <mat-icon color="primary">add</mat-icon>
        </button> -->
    </div>

    <div class="flex-container">
        <mat-form-field>
            <mat-label>Turn Order</mat-label>
            <input
                matInput
                type="number"
                formControlName="turnOrder"
            />
        </mat-form-field>
    </div>
    
    <div>
        <mat-form-field>
            <mat-label>End Position</mat-label>
            <input
                matInput
                type="number"
                formControlName="endPosition"
            />
        </mat-form-field>
    </div>

    <div>
        <mat-form-field>
            <mat-label>Notes</mat-label>
            <textarea
                matInput
                cdkTextareaAutosize
                formControlName="notes"
            ></textarea>
        </mat-form-field>
    </div>
</form>